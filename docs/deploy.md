### 灰度发布和蓝绿发布

#### 蓝绿发布：

项目逻辑上分为AB组，在项目系统时，首先把A组从负载均衡中摘除，进行新版本的部署。B组仍然继续提供服务。

当A组升级完毕，负载均衡重新接入A组，再把B组从负载列表中摘除，进行新版本的部署。A组重新提供服务。

最后，B组也升级完成，负载均衡重新接入B组，此时，AB组版本都已经升级完成，并且都对外提供服务。

#### 灰度发布：

灰度发布只升级部分服务，即让一部分用户继续用老版本，一部分用户开始用新版本，如果用户对新版本没什么意见，那么逐步扩大范围，把所有用户都迁移到新版本上面来。

部署过程：从LB摘掉灰度服务器，升级成功后再加入LB；

少量用户流量到新版本；

如果灰度服务器测试成功，升级剩余服务器。

两种方式均可以做到平滑式升级，在升级过程中服务仍然保持服务的连续性，升级对外界是无感知的。

那生产上选择哪种部署方法最合适呢？这取决于哪种方法最适合你的业务和技术需求。如果你们运维自动化能力储备不够，肯定是越简单越好，建议蓝绿发布，如果业务对用户依赖很强，建议灰度发布。

蓝绿发布：两套环境交替升级，旧版本保留一定时间便于回滚。

灰度发布：根据比例将老版本升级，例如80%用户访问是老版本，20%用户访问是新版本。

maven命令

总目录下
clean install -Dmaven.test.skip=true
Web层目录下
clean package -Dmaven.test.skip=true

-X package -Dstart-class=com.huawei.web.DbaseApplication
maven构建的生命周期

外部tomcat启动后，访问404
URL路径加上war包项目名称

ADS和ALB服务

部署步骤：
  打war包，本地测试。
  上传war包到his-beta，全量，中断部署。
  访问URL地址，测试。
